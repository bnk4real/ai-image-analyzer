generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  schemas  = ["public"]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model people {
  first_name    String?         @default("")
  last_name     String?
  username      String?         @unique
  password_hash String?
  created_at    DateTime        @default(now())
  user_id       String          @id @db.Uuid
  email         String?         @unique
  sessions      sessions[]
  subscriptions subscriptions[]

  @@schema("public")
}

model sessions {
  id         String   @id @db.Uuid
  user_id    String   @db.Uuid
  token_hash String   @unique
  expires_at DateTime
  created_at DateTime @default(now())
  people     people   @relation(fields: [user_id], references: [user_id], onDelete: Cascade)

  @@index([user_id])
  @@schema("public")
}

model subscriptions {
  id                String    @id @db.Uuid
  user_id           String    @db.Uuid
  name              String
  provider          String?
  price_cents       Int
  currency          String    @default("USD")
  billing_cycle     String    @default("monthly")
  next_payment_date DateTime?
  website_url       String?
  notes             String?
  created_at        DateTime  @default(now())
  updated_at        DateTime
  people            people    @relation(fields: [user_id], references: [user_id], onDelete: Cascade)

  @@index([next_payment_date])
  @@index([user_id])
  @@schema("public")
}

model Report {
  id        String   @id @default(cuid())
  title     String
  prompt    String?
  findings  Json
  images    Image[]
  createdAt DateTime @default(now())

  @@schema("public")

}

model Image {
  id        String   @id @default(cuid())
  report    Report   @relation(fields: [reportId], references: [id])
  reportId  String
  filename  String
  mimeType  String
  size      Int

  @@schema("public")

}

model ai_models {
  id          String   @id @default(uuid())
  name        String   @unique
  description String?
  created_at  DateTime @default(now())

  @@schema("public")
}
